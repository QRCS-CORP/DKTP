<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DKTP: Dual Key Tunneling Protocol: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/DKTP/DKTP/kex.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dktp_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DKTP: Dual Key Tunneling Protocol<span id="projectnumber">&#160;1.0.0.0a (A1)</span>
   </div>
   <div id="projectbrief">A quantum secure dual-key encrypted tunneling protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('kex_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">kex.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>DKTP Key Exchange Functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="dktp_8h_source.html">dktp.h</a>&quot;</code><br />
</div>
<p><a href="kex_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:dktp_5Fkex_5Fclient_5Fstate" id="r_dktp_5Fkex_5Fclient_5Fstate"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdktp__kex__client__state.html">dktp_kex_client_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal state for the Duplex key exchange (client-side).  <a href="structdktp__kex__client__state.html#details">More...</a><br /></td></tr>
<tr class="memitem:dktp_5Fkex_5Fserver_5Fstate" id="r_dktp_5Fkex_5Fserver_5Fstate"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdktp__kex__server__state.html">dktp_kex_server_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal state for the Duplex key exchange (server-side).  <a href="structdktp__kex__server__state.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a31bb9f2641fed2eb67b1996391bca080" id="r_a31bb9f2641fed2eb67b1996391bca080"><td class="memItemLeft" align="right" valign="top"><a id="a31bb9f2641fed2eb67b1996391bca080" name="a31bb9f2641fed2eb67b1996391bca080"></a>
typedef struct dktp_kex_client_state&#160;</td><td class="memItemRight" valign="bottom"><b>dktp_kex_client_state</b></td></tr>
<tr class="memitem:af330ae3da79cfa859aeadfb3dedd6219" id="r_af330ae3da79cfa859aeadfb3dedd6219"><td class="memItemLeft" align="right" valign="top"><a id="af330ae3da79cfa859aeadfb3dedd6219" name="af330ae3da79cfa859aeadfb3dedd6219"></a>
typedef struct dktp_kex_server_state&#160;</td><td class="memItemRight" valign="bottom"><b>dktp_kex_server_state</b></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a14a62821869df683f7757bacefb4b5ec" id="r_a14a62821869df683f7757bacefb4b5ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dktp_8h.html#a96544b19420e25bae64b71943d4ce4c1">dktp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14a62821869df683f7757bacefb4b5ec">dktp_kex_server_key_exchange</a> (<a class="el" href="structdktp__kex__server__state.html">dktp_kex_server_state</a> *kss, <a class="el" href="structdktp__connection__state.html">dktp_connection_state</a> *cns)</td></tr>
<tr class="memdesc:a14a62821869df683f7757bacefb4b5ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the server-side key exchange.  <br /></td></tr>
<tr class="memitem:a128acaa6ad29451ff2d64f3b4efa390e" id="r_a128acaa6ad29451ff2d64f3b4efa390e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dktp_8h.html#a96544b19420e25bae64b71943d4ce4c1">dktp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a128acaa6ad29451ff2d64f3b4efa390e">dktp_kex_client_key_exchange</a> (<a class="el" href="structdktp__kex__client__state.html">dktp_kex_client_state</a> *kcs, <a class="el" href="structdktp__connection__state.html">dktp_connection_state</a> *cns)</td></tr>
<tr class="memdesc:a128acaa6ad29451ff2d64f3b4efa390e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the client-side key exchange.  <br /></td></tr>
<tr class="memitem:a80a94ea89ba4fef18da788aa4d3c5853" id="r_a80a94ea89ba4fef18da788aa4d3c5853"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80a94ea89ba4fef18da788aa4d3c5853">dktp_kex_test</a> (void)</td></tr>
<tr class="memdesc:a80a94ea89ba4fef18da788aa4d3c5853"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run internal tests for the key exchange functions.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>DKTP Key Exchange Functions. </p>
<p>This header file contains the internal key exchange functions for the Dual Key Tunneling Protocol (DKTP).</p>
<p>The file defines internal state structures for both the client and server roles in the key exchange. These structures encapsulate various cryptographic parameters such as key identities, session token hashes, asymmetric keys (for encryption, signing, and verification), shared secrets, and session expiration times.</p>
<p>The following internal (non-exportable) functions are declared:</p>
<ul>
<li><code>dktp_kex_server_key_exchange:</code> Executes the server-side Duplex key exchange.</li>
<li><code>dktp_kex_client_key_exchange:</code> Executes the client-side Duplex key exchange.</li>
<li><code>dktp_kex_simplex_server_key_exchange:</code> Executes the server-side Simplex key exchange.</li>
<li><code>dktp_kex_simplex_client_key_exchange:</code> Executes the client-side Simplex key exchange.</li>
<li><code>dktp_kex_test:</code> Runs a suite of internal tests to validate the correctness of the key exchange operations.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>These functions and state structures are internal and are not part of the public DKTP API. </dd></dl>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a128acaa6ad29451ff2d64f3b4efa390e" name="a128acaa6ad29451ff2d64f3b4efa390e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a128acaa6ad29451ff2d64f3b4efa390e">&#9670;&#160;</a></span>dktp_kex_client_key_exchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dktp_8h.html#a96544b19420e25bae64b71943d4ce4c1">dktp_errors</a> dktp_kex_client_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdktp__kex__client__state.html">dktp_kex_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>kcs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdktp__connection__state.html">dktp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the client-side key exchange. </p>
<p>This function initiates and completes the key exchange from the client side. It processes the server's response, computes the shared secret, and updates the DKTP connection state with the derived cryptographic parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kcs</td><td>A pointer to the client key exchange state structure. </td></tr>
    <tr><td class="paramname">cns</td><td>A pointer to the current DKTP connection state.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="dktp_8h.html#a96544b19420e25bae64b71943d4ce4c1" title="The DKTP error values.">dktp_errors</a></code> representing the result of the key exchange operation.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is an internal non-exportable API. </dd></dl>

</div>
</div>
<a id="a14a62821869df683f7757bacefb4b5ec" name="a14a62821869df683f7757bacefb4b5ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14a62821869df683f7757bacefb4b5ec">&#9670;&#160;</a></span>dktp_kex_server_key_exchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dktp_8h.html#a96544b19420e25bae64b71943d4ce4c1">dktp_errors</a> dktp_kex_server_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdktp__kex__server__state.html">dktp_kex_server_state</a> *</td>          <td class="paramname"><span class="paramname"><em>kss</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdktp__connection__state.html">dktp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the server-side key exchange. </p>
<p>This function processes an incoming key exchange request on the server side. It uses the server key exchange state (<code><a class="el" href="structdktp__kex__server__state.html" title="Internal state for the Duplex key exchange (server-side).">dktp_kex_server_state</a></code>) to verify client credentials, exchange the necessary asymmetric keys, and update the DKTP connection state accordingly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kss</td><td>A pointer to the server key exchange state structure. </td></tr>
    <tr><td class="paramname">cns</td><td>A pointer to the current DKTP connection state.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="dktp_8h.html#a96544b19420e25bae64b71943d4ce4c1" title="The DKTP error values.">dktp_errors</a></code> indicating the outcome of the key exchange process.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is an internal non-exportable API. </dd></dl>

</div>
</div>
<a id="a80a94ea89ba4fef18da788aa4d3c5853" name="a80a94ea89ba4fef18da788aa4d3c5853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80a94ea89ba4fef18da788aa4d3c5853">&#9670;&#160;</a></span>dktp_kex_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dktp_kex_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run internal tests for the key exchange functions. </p>
<p>This function executes a suite of internal tests designed to validate the correct operation of the DKTP key exchange mechanisms. The tests include:</p>
<ul>
<li>Verifying the proper initialization and management of state structures.</li>
<li>Testing the cryptographic operations involved in key generation, shared secret derivation, and session token hashing.</li>
<li>Ensuring that the key exchange functions correctly update the DKTP connection state.</li>
</ul>
<p>The function returns true if all internal tests pass, confirming the reliability and correctness of the key exchange implementation.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the key exchange tests succeed; otherwise, false.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is an internal non-exportable API. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_b9edba6ce4064bbb490bb6c4b3b73d6f.html">DKTP</a></li><li class="navelem"><a href="kex_8h.html">kex.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
